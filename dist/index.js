var e=function(e,n,i){this.tile=e,this.tiles_range=-1===e?Array.from(new Array(this.max_bin)).map(function(e,n){return n}):Array.from(new Array(e)).map(function(n,t){return Math.round(i*t/e)}),this.bin_length=n||0,this.max_bin=Number.isNaN(i)?-1:i};e.prototype.tiles=function(e){var n=this.tiles_range.length;return this.tiles_range.forEach(function(i,t){i<=e&&(n=t)}),n},e.prototype.tubeify=function(e){var n=this,i=[],t={},a=0;e.forEach(function(e){void 0===t[e.name]&&(t[e.name]={}),t[e.name][e.bin_id]=e,a<e.bin_id&&(a=e.bin_id)}),-1===this.max_bin&&(this.max_bin=a);var r=-1,s=-1,u=-1;e.forEach(function(e){e.begins.forEach(function(t,a){u!==e.path_name?(r=0,u=e.path_name,s+=1):r+=1;var o=[{nodeName:String(e.bin_id),mismatches:[]}];e.begins[a][0]+1!==e.bin_id-1&&-1!==e.begins[a][0]&&o[0].mismatches.push({type:"link",pos:0,seq:"L",query:e.begins[a][0]+1}),e.ends[a][0]+1!==e.bin_id+1&&-1!==e.ends[a][0]&&o[0].mismatches.push({type:"link",pos:n.bin_length,seq:"L",query:e.ends[a][0]+1}),i.push({firstNodeOffset:0,finalNodeCoverLength:n.bin_length,mapping_quality:60,is_secondary:!1,sequence:[String(e.bin_id)],sequenceNew:o,type:"read",read_id:r,name:e.path_name,id:s})})});var o=-1,h=-1,c=[],m=[];i.forEach(function(e){(e.id!==h||parseInt(e.sequence[0])!==o+1)&&c.length>0?(m.push({firstNodeOffset:0,finalNodeCoverLength:c.length,mapping_quality:60,is_secondary:!1,sequence:c.map(function(e){return e.sequence[0]}),sequenceNew:c.map(function(e){return e.sequenceNew[0]}),type:"read",name:c[0].name,id:h}),h=e.id,c=[e]):e.id!==h||parseInt(e.sequence[0])!==o+1?(h=e.id,c=[e]):c.push(e),o=parseInt(e.sequence[0])}),c.length>0&&m.push({firstNodeOffset:0,finalNodeCoverLength:this.bin_length*c.length,mapping_quality:60,is_secondary:!1,sequence:c.map(function(e){return e.sequence[0]}),sequenceNew:c.map(function(e){return e.sequenceNew[0]}),type:"read",name:c[0].name,id:h}),i=m;var f={},p=Array.from(new Array(this.max_bin)).map(function(e,i){return{name:String(i+1),sequenceLength:n.bin_length}});return f.nodes=p,f.tracks=[{id:0,name:"REF",sequence:p.map(function(e){return e.name})}],f.reads=i,f},exports.Tubeify=e;
//# sourceMappingURL=index.js.map
